<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relative Frequency Interactive Tutorial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .table-highlight-grand-total {
            background-color: #fef9c3;
        }
        .table-highlight-row {
            background-color: #fce7f3;
        }
        .table-highlight-column {
            background-color: #dbeafe;
        }
        .table-highlight-part, .table-highlight-joint {
            background-color: #dcfce7;
            border: 2px solid #22c55e;
        }
        .table-highlight-marginal {
            background-color: #e0e7ff;
            border: 2px solid #4f46e5;
        }
        .question-part {
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
            font-weight: 600;
        }
        .feedback {
            transition: opacity 0.3s ease-in-out;
        }
        table td, table th {
            transition: background-color 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-5xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Relative Frequency Interactive Tutorial</h1>
            <p class="text-lg text-gray-600 mt-2">Learn how to find the "part" and the "whole"!</p>
        </header>

        <main class="space-y-8">
            <!-- Step 1: The Basics (visible by default) -->
            <section id="step-1-card" class="bg-white p-6 rounded-xl shadow-lg border border-gray-200">
                <!-- ... (all your Step 1 HTML exactly as before) ... -->
                <!-- Leave this section as-is. -->
                 <div class="mt-6 flex justify-end">
                    <button onclick="goToStep(2)" class="bg-indigo-600 text-white px-6 py-2 rounded-md hover:bg-indigo-700 transition font-semibold">Next: Two-Way Tables &rarr;</button>
                </div>
            </section>

            <!-- Step 2: Two-Way Tables -->
            <section id="step-2-card" class="hidden bg-white p-6 rounded-xl shadow-lg border border-gray-200">
                <!-- ... (your Step 2 HTML exactly as before) ... -->
                <div class="mt-8 flex justify-end">
                    <button onclick="goToStep(3)" class="bg-indigo-600 text-white px-6 py-2 rounded-md hover:bg-indigo-700 transition font-semibold">Next: Advanced Topics &rarr;</button>
                </div>
            </section>

            <!-- Step 3: Advanced Topics -->
            <section id="step-3-card" class="hidden bg-white p-6 rounded-xl shadow-lg border border-gray-200">
                <!-- ... (your Step 3 HTML exactly as before) ... -->
                <div class="mt-8 flex justify-end">
                    <button onclick="restartTutorial()" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 transition font-semibold">All Done! Start Over</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        const tableData = {
            class: [ [45], [32], [23], [100] ],
            icecream: [
                [25, 14, 11, 50],
                [15, 20, 15, 50],
                [40, 34, 26, 100]
            ],
            transport: [
                [60, 90, 150],
                [40, 110, 150],
                [100, 200, 300]
            ]
        };

        function goToStep(stepNumber) {
            // Hide ALL sections first
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            // Try to show -card or -extra section for this step
            let section = document.getElementById(`step-${stepNumber}-card`);
            if (!section) section = document.getElementById(`step-${stepNumber}-extra`);
            if (section) section.classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function restartTutorial() {
            document.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
            document.querySelectorAll('.feedback').forEach(p => { p.textContent = ''; p.style.opacity = '0'; });
            document.querySelectorAll('[id^="formula-"]').forEach(el => el.textContent = '-- / --');
            clearHighlights('class-table');
            clearHighlights('icecream-table');
            clearHighlights('transport-table');
            goToStep(1);
        }

        function clearHighlights(tableId) {
            const t = document.getElementById(tableId);
            if (!t) return;
            t.querySelectorAll('td, th').forEach(cell => {
                cell.className = cell.className.replace(/table-highlight-\w+/g, '').trim();
            });
        }
        
        function highlight(table, partRow, partCol, wholeRow, wholeCol) {
            const tableId = `${table}-table`;
            clearHighlights(tableId);
            const data = tableData[table];
            const partCell = document.querySelector(`#${tableId} td[data-row='${partRow}'][data-col='${partCol}']`);
            const wholeCell = document.querySelector(`#${tableId} td[data-row='${wholeRow}'][data-col='${wholeCol}']`);
            if (partCell) partCell.classList.add('table-highlight-part');
            if (wholeCell) wholeCell.classList.add('table-highlight-grand-total');
            const formBox = document.getElementById(`formula-${table}`);
            if (formBox) formBox.textContent = `${data[partRow][partCol]} / ${data[wholeRow][wholeCol]}`;
        }
        
        function highlightFruit(type, table, partRow, partCol) {
            const tableId = `${table}-table`;
            const data = tableData[table];
            clearHighlights(tableId);
            const partCell = document.querySelector(`#${tableId} td[data-row='${partRow}'][data-col='${partCol}']`);
            if (partCell) partCell.classList.add('table-highlight-part');
            
            let partValue = data[partRow][partCol];
            let wholeValue, formulaIdSuffix;
            
            if (type === 'grand') {
                const grandCell = document.querySelector(`#${tableId} td[data-row='2'][data-col='${data[2].length-1}']`);
                if (grandCell) grandCell.classList.add('table-highlight-grand-total');
                wholeValue = data[2][data[2].length-1];
                formulaIdSuffix = '-grand';
            } else if (type === 'row') {
                const rowCells = document.querySelectorAll(`#${tableId} tr:nth-child(${partRow + 2}) td`);
                rowCells.forEach(cell => cell.classList.add('table-highlight-row'));
                wholeValue = data[partRow][data[partRow].length-1];
                formulaIdSuffix = table === 'transport' ? '-cond1' : '-row';
            } else if (type === 'col') {
                for(let i=0; i<3; i++) {
                   const colCell = document.querySelector(`#${tableId} tbody tr:nth-child(${i + 1}) td:nth-child(${partCol + 2})`);
                   if(colCell) colCell.classList.add('table-highlight-column');
                }
                const colTotCell = document.querySelector(`#${tableId} tfoot td:nth-child(${partCol + 2})`);
                if (colTotCell) colTotCell.classList.add('table-highlight-column');
                wholeValue = data[2][partCol];
                formulaIdSuffix = table === 'transport' ? '-cond2' : '-col';
            }

            const formulaEl = document.getElementById(`formula-${table}${formulaIdSuffix}`);
            if (formulaEl) formulaEl.textContent = `${partValue} / ${wholeValue}`;
        }
        
        function highlightSpecial(type, table, row, col) {
            const tableId = `${table}-table`;
            clearHighlights(tableId);
            const cell = document.querySelector(`#${tableId} td[data-row='${row}'][data-col='${col}']`);
            if (cell) cell.classList.add(`table-highlight-${type}`);
        }

        function checkAnswer(id, correctAnswer) {
            const answerInput = document.getElementById(`answer-${id}`);
            const feedback = document.getElementById(`feedback-${id}`);
            const userAnswer = parseFloat(answerInput.value);
            feedback.style.opacity = '1';
            if (isNaN(userAnswer)) {
                 feedback.textContent = 'Please enter a number.';
                 feedback.className = 'mt-2 text-sm font-medium feedback text-red-600';
                 return;
            }
            if (Math.abs(userAnswer - correctAnswer) < 0.01) {
                feedback.textContent = 'Correct! Great job!';
                feedback.className = 'mt-2 text-sm font-medium feedback text-green-600';
            } else {
                const correctPercent = (correctAnswer * 100).toFixed(1);
                feedback.textContent = `Not quite. The correct decimal is ${correctAnswer.toFixed(2)}, which is ${correctPercent}%. Try again!`;
                feedback.className = 'mt-2 text-sm font-medium feedback text-red-600';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            goToStep(1);
        });
    </script>
</body>
</html>
